var restaurant,map;window.initMap=function(){fetchRestaurantFromURL(function(a,b){a?console.error(a):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:b.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})};
var fetchRestaurantFromURL=function(a){if(self.restaurant)a(null,self.restaurant);else{var b=getParameterByName("id");b?DBHelper.fetchRestaurantById(b,function(b,c){(self.restaurant=c)?(fillRestaurantHTML(),a(null,c)):console.error(b)}):(error="No restaurant id in URL",a(error,null))}},fillRestaurantHTML=function(a){a=void 0===a?self.restaurant:a;document.getElementById("restaurant-name").innerHTML=a.name;document.getElementById("restaurant-address").innerHTML=a.address;var b=document.getElementById("restaurant-img");
b.className="restaurant-img";b.alt="image of "+a.name+" restaurant";b.src=DBHelper.imageUrlForRestaurant(a)+".jpg";document.getElementById("restaurant-cuisine").innerHTML=a.cuisine_type;a.operating_hours&&fillRestaurantHoursHTML();fillReviewsHTML()},fillRestaurantHoursHTML=function(a){a=void 0===a?self.restaurant.operating_hours:a;var b=document.getElementById("restaurant-hours"),d;for(d in a){var c=document.createElement("tr"),e=document.createElement("td");e.innerHTML=d;c.appendChild(e);e=document.createElement("td");
e.innerHTML=a[d];c.appendChild(e);b.appendChild(c)}},fillReviewsHTML=function(a){a=void 0===a?self.restaurant.reviews:a;var b=document.getElementById("reviews-container"),d=document.createElement("h2");d.innerHTML="Reviews";b.appendChild(d);if(a){var c=document.getElementById("reviews-list");a.forEach(function(a){c.appendChild(createReviewHTML(a))});b.appendChild(c)}else a=document.createElement("p"),a.innerHTML="No reviews yet!",b.appendChild(a)},createReviewHTML=function(a){var b=document.createElement("li"),
d=document.createElement("div"),c=document.createElement("section");d.innerHTML=a.name;d.tabIndex="0";b.appendChild(c);c.appendChild(d);d=document.createElement("div");d.innerHTML=a.date;c.appendChild(d);c=document.createElement("p");c.innerHTML="Rating: "+a.rating;b.appendChild(c);c=document.createElement("p");c.innerHTML=a.comments;b.appendChild(c);return b},fillBreadcrumb=function(a){a=void 0===a?self.restaurant:a;var b=document.getElementById("breadcrumb"),d=document.createElement("li");d.innerHTML=
a.name;b.appendChild(d)},getParameterByName=function(a,b){b||(b=window.location.href);a=a.replace(/[\[\]]/g,"\\$\x26");return(a=(new RegExp("[?\x26]"+a+"(\x3d([^\x26#]*)|\x26|#|$)")).exec(b))?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null};